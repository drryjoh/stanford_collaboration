#include <cmath>
#include <algorithm>
#include <array>
#include <iostream>  // For printing the result to the console
#include "types_inl.h"
#include "multiply_divide.h"
#include "pow_gen.h"
#include "exp_gen.h"
#include "array_handling.h"
#include "constants.h"
#include "thermally_perfect.h"
#include "arrhenius.h"
#include "third_body.h"
#include "falloff_troe.h"
#include "falloff_lindemann.h"
#include "falloff_sri.h"
#include "pressure_dependent_arrhenius.h"
#include "reactions.h"
#include "source.h"
#include "chemical_state_functions.h"

// Overload << operator for std::array
template <typename T, std::size_t N>
std::ostream& operator<<(std::ostream& os, const std::array<T, N>& arr) {
    os << "[ ";
    for (const auto& value : arr) 
    {
        os << value << " ";
    }
    os << "]";
    return os;
}

int main() {
    std::cout << "*** ChemGen ***" <<std::endl;
    Species species  = {double(0.0012002111597230667),double(0.000682826538614617),double(0.00182712808349876),double(0.00029394292699789766),double(2.8491664406948088e-05),double(0.002029084168751451),double(0.0005438368949183862),double(0.001833575455279703),double(0.0014104752536331752),double(0.0005205037842473764),double(0.0014133105784646326),double(0.0004954956596080153),double(0.001698782791144724),double(0.0003104738830031645),double(0.000972117854668351),double(0.0019105177446855383),double(0.0018596199912095839),double(0.0010469723183407077),double(0.0014343067363640255),double(0.0012021879062813691),double(0.0018324709008837683),double(0.0019496774929972705),double(0.00057810162678811),double(0.0008191467951835485),double(0.0008288033345739559),double(0.0008822788527144613),double(0.00047887899398826276),double(0.00029365419638919263),double(0.001446720609533312),double(0.0018640430079649864)};
    double temperature_ =  2795.8206170402054;
    Species result = source_species(species, temperature_);


    double pressure_return = pressure(species, temperature_);
    double int_energy = internal_energy_volume_specific(species, temperature_);
    std::cout << "temperature: " << temperature_<<std::endl;
    for(int i=0; i<10; ++i)
    {
        std::cout << "temperature_ for "<< i <<" iterations: " << (temperature_ - temperature(int_energy, species, i)) / (temperature_)<<std::endl;
    }
    // Output the result
    std::cout << "Source test result:  " << result << std::endl;
    std::cout << "Cantera test result: " <<"692093.7702294824 5996499.951860712 -3053238.2172442833 37614.20292287793 1195202.982181945 -75383.07189349187 -213885.46824546278 -1142622.1441777993 -1365147.6393455327 -117551.62991869495 8360516.213990631 73275.17798241189 8869114.59144898 382523.86928767205 182198.34851799347 3008413.4451069385 -2980299.08551058 -71552.12572053826 1025448.8850938374 -287281.55060912203 1189381.6512338563 -1513095.9566216983 -466649.73294872814 -246306.21267300658 278563.28722154535 -7590771.275086217 369279.14652174443 121743.61801151805 -336561.41141330806 0.0"<<std::endl;

    
    std::cout << "ChemGen internal energy: "<< int_energy <<std::endl;
    std::cout << "Cantera internal energy: " <<"8897382.288394576"<<std::endl;

    
    std::cout << "Chemgen species cps: " << species_specific_heat_constant_pressure_mass_specific(temperature_) <<std::endl;
    std::cout << "Cantera species cps: " <<"18122.831300791975 20621.18704899117 1306.2281705039534 1237.659394048824 2154.96630623307 3112.637388154236 1803.9542714846207 3155.2513471748393 3919.3533839903744 4114.383165488285 5179.701739231191 7028.5491816764725 1325.866461680671 1409.7425183643727 2172.445252617529 2643.29051500532 3334.100499783329 2520.7244861339027 3286.6291520901323 3770.5087020978713 4469.236992405247 4983.915617234644 5585.583304675838 2005.4959812290306 2463.037029392419 2859.047355878006 3030.008591646311 3737.0299231291997 3254.267037926232 1318.8352922883046"<<std::endl;

    
    std::cout << "Chemgen species enthalpies: " << species_enthalpy_mass_specific(temperature_) <<std::endl;
    std::cout << "Cantera species enthalpies: " <<"40263721.11194812 267771982.97237375 18843610.43645951 2813176.532902601 7030208.413258888 -6978918.436439632 4239368.966403781 52575476.37781044 36426073.718978256 39213494.187629044 20564143.88052497 8684931.67882389 -877154.2020950984 -5755730.219985517 6001061.448454712 1927643.1211110966 7744831.880261627 28316337.42130404 15753177.238151424 18840697.58541449 11024390.53245223 14299761.936698787 8473628.190164661 8849854.113739753 4188098.3902696325 5794143.77726991 22374727.921763584 12450791.715456933 16063344.746020708 3040685.810525163"<<std::endl;
    
    std::cout << "Chemgen species internal energies: " << species_internal_energy_mass_specific(temperature_) <<std::endl;
    std::cout << "Cantera species internal energies: " <<"28733093.132065725 244710727.01260898 17390660.5016234 2086701.5654845464 5663374.403295761 -8269273.474321559 3535080.473177008 50789951.68256174 34768859.34616562 37556279.81481641 19018035.06725973 7235966.6468820525 -1707063.0206400077 -6283934.587443149 5199981.22213164 1153455.8831359113 6995790.634935763 27387622.03946453 14860414.89052707 17981208.344586164 10195783.34604591 13499894.549476884 7700573.78353204 8283285.44261828 3635115.398918135 5254110.184345228 21481965.57413923 11870590.891609611 15468169.847604474 2210895.4911333267"<<std::endl;

    std::cout << "Chemgen species internal entropies: " << species_entropy_mass_specific(temperature_) <<std::endl;
    std::cout << "Cantera species internal entropies: " <<"90923.85418642884 143095.3628327819 11952.472848710315 8272.598661243692 13954.140893272792 14765.891192542696 9591.155448438589 18443.2634690704 19684.028531631015 19281.69914130209 20331.315758654324 20459.413885841077 9067.784487833498 7106.607034417296 10811.02808247578 11076.090782779716 12537.951737874393 12511.3612613546 12735.984282315423 14164.931546017307 14207.496930801857 15556.390531777815 15551.235885773563 9322.80003531311 9874.862040655546 10536.19863062073 13123.909322193262 11879.776451238882 11838.164413175311 8826.908366647576"<<std::endl;

    
    std::cout << "Chemgen species gibbs energy: " << species_gibbs_energy_mole_specific(temperature_) <<std::endl;
    std::cout << "Cantera species gibbs energy: " <<"-431309219.0465057 -133355358.49947354 -233159179.89767054 -650056180.4917334 -543936010.0817538 -869434551.8293349 -745136233.54715 13167678.61361054 -260999534.4213436 -206122245.54534277 -545448268.2122458 -778340896.1497661 -734675775.2038465 -1127709882.8546994 -702950422.3296262 -871928612.483788 -847508501.6930771 -166779504.04094535 -516967570.4202695 -561526619.7506206 -805071874.4945071 -848410320.8816694 -1052595470.2324786 -706315155.4253757 -984516817.7700164 -1018581478.9074385 -372795636.76897335 -831866879.1036469 -665298476.3867431 -606160393.1310382"<<std::endl;
    
    std::cout << "Chemgen species gibbs reactions : " << gibbs_reaction(log_gen(temperature_)) <<std::endl;
    std::cout << "Cantera species gibbs reactions : " <<"0.27172064126315293 -0.5516265054666517 -0.5516265054666517 -1.1849342753607168 -0.6333077698940652 7.080801020318166 -7.904148167047971 -7.63242752578482 8.26573529567889 8.26573529567889 1.646550961702927 -8.72735198202109 -9.007257846224594 -9.64056561611866 -9.278978487487738 -9.912286257381808 -9.912286257381808 -6.877599355253776 1.026548811794193 0.7548281705310347 0.7548281705310347 -8.25242967569355 -7.1015450018613135 -14.182346022179479 -14.733972527646124 -13.97914435711509 -15.367280297540194 -5.454994040158397 -15.353974677554868 -27.877773086386135 -13.14380055874 1.023268838283871 -5.476560216161231 -6.410510452958753 -12.872079917476853 -26.851224274591942 -27.606052445122977 -19.973624919338167 0.6535794187889515 -13.89862872927104 -6.499829054445102 -21.82024090435185 -8.61871356660335 -2.2082031136445983 -17.625971412827948 0.5809719658730667 -21.54852026308869 -20.793692092557656 -8.3469929253402 -27.874493112875815 -29.814255558767574 -17.314612014737616 -11.257079832703324 -12.135802691919034 -2.360745439549668 -3.3840142778335442 -24.180986343901523 -10.97945900615302 -1.7797734736766064 -2.360745439549668 -2.360745439549673 -9.794524730792302 -2.360745439549668 -2.360745439549673 -11.734287176684074 -1.5324451898976434 -12.649900832281835 -5.5483558304205305 -12.649900832281835 -6.099982335887183 -6.733290105781247 3.17899615160057 -11.14660903187832 -4.967383864547458 -7.328129304097132 -7.795399475118669 -3.2077724916141577 -4.28195633756716 -9.751312037943064 -22.401212870224903 -1.7659062412337887 0.5948391983158844 -9.199685532476417 -5.928507299270082 -4.338858816711721 4.940119670776031 -9.479591396679911 -6.994887950655424 -5.677573450132922 -8.03831888968259 1.6476591536253402 4.6946592726431255 -11.38350133942847 -2.7495111476695113 -6.787283541671117 -13.868084561989292 -4.668399029512873 -4.073559831196989 -14.419711067455943 -15.053018837350008 -5.140732579968191 -11.069239879238284 -3.913570858981818 -2.798844682751009 -3.3504711882176603 -3.9837789581117358 -7.4531492946000535 -2.217872716877947 -4.578618156427615 -5.045888327449157 -9.327844665016311 -13.833473554630546 -5.547466610056773 -2.2470436446981488 -26.705553472107393 -4.350366161273576 -28.53135250517509 -7.5311787740427265 -27.50480369338089 -15.3298251674266 -13.797379977528951 -24.02572361556085 -14.148296423889477 -24.679303034349804 6.202078161102449 3.8198950096370883 -3.852049470825277 -10.563161071648521 -2.4507105837440637 1.0621093693374264 -9.430562600308813 -11.457968429968654 -5.226879791265051 -6.202078161102452 -8.652788744846513 -16.47824196633222 0.48002296211964196 -0.8497123816145667 -6.979852016564749 -1.4013388870812185 -7.357622317373417 -8.097173862748862 -16.73116405450782 -2.034646656975284 -6.225023846033694 -2.311452987051876 -13.974739967220168 -4.740217681511785 -10.900696029955247 -4.698617868852798 -13.903033119165968 -12.085630305315963 -6.148912608084577 -1.99925644716488 -1.99925644716488 -17.532413947513046 -11.006514293389484 -5.998884952117999 -2.173344047934166 -15.6285040047645 -22.73004900662582 -28.278404837046338 -7.400223839199217 -13.631312477902819 -8.10185134720425 -11.251201162781017 -4.149656160919697 -15.533157500348166 -11.903776672001088 -18.12880051803478 -12.537084441895152 -11.251201162781017 -19.503630838474557 -2.6247981845133346 -8.553305483783426 0.0415998126589876 3.87240366833094 -2.340583338806373 -9.04112245235761 -4.891466291437914 -4.073738587810153 6.386768643214718 -3.5255176141671 -2.941140116470429 -14.067282474853284 0.45826134394462564 -3.047000119017785 -10.953204688649103 -14.445971310586193 -11.504831194115766 -12.13813896400983 -0.026260243130252103 -2.225852706628003 -15.820801631025969 -8.154360005898095 -1.5145549291201368 -4.033800901300384 -4.585427406767035 4.693551080720707 -5.218735176661111 -13.382764785792544 -5.813574374976995 -1.2349562185493748 -3.7179302658367384 -0.889914655265528 -3.250660094815196 -7.601026256088762 -6.033381772106326 -16.007771189705924 -2.376458711803102 -14.218221395176196 -18.485261559889008 -3.0753304126526064 -3.0753304126526064 -8.530324452810994 -8.530324452810994 -8.412589538479862 -1.42877945094969 -7.455903616374803 -5.652021569368483 -4.181134948229889 -6.20364807483513 -8.033184419055166 -20.421869470011327 -6.8369558447292 -6.631845531973942 -21.796699790451104 -2.853176886617465 -7.899065214066622 -3.311438230562101 -4.120356812482979"<<std::endl;

    std::cout << "Pressure: " <<pressure_return <<std::endl;
    std::cout << "Temperature Monomial at 300           : " <<temperature_monomial(double(300)) <<std::endl;
    std::cout << "Temperature Energy Monomial at 300           : " <<temperature_energy_monomial(double(300)) <<std::endl;
    std::cout << "Temperature Entropy Monomial at 300           : " <<temperature_entropy_monomial(double(300)) <<std::endl;
    std::cout << "Temperature Gibbs Monomial at 300           : " <<temperature_gibbs_monomial(double(300)) <<std::endl;
    
    return 0;
}
            